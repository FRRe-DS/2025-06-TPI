import{_ as sa}from"../chunks/PPVm8Dsz.js";import"../chunks/DsnmJJEf.js";import"../chunks/BfMTlK6c.js";import{o as oa,a as ia}from"../chunks/BGtgH5ej.js";import{p as la,aa as U,ab as na,ac as z,b as da,ad as m,ae as l,af as d,O as _,x as a,ag as V,ah as o,u as S,ai as W}from"../chunks/BCZT5Dbg.js";import{e as Z,s as x}from"../chunks/CLcpye_t.js";import{i as k}from"../chunks/njmLvgol.js";import{e as q,i as G}from"../chunks/CLhoNAXF.js";import{f,a as v,c as ca}from"../chunks/BpGtaleV.js";import{s as L}from"../chunks/Bm2xQnLq.js";import{b as va}from"../chunks/DIFBLlPq.js";import{i as pa}from"../chunks/Ck-BG2pa.js";import{g as ua}from"../chunks/DaeG8Ll7.js";var ma=f("<button> </button>"),_a=f('<div class="loading-indicator svelte-pzrwm3"><p>Cargando datos...</p></div>'),fa=f('<div class="error-message svelte-pzrwm3"><p> </p></div>'),ga=f('<div class="kpi-card svelte-pzrwm3"><span class="kpi-value svelte-pzrwm3"> </span> <span class="kpi-label svelte-pzrwm3"> </span></div>'),ha=f('<div class="kpi-grid svelte-pzrwm3"></div> <div class="chart-container svelte-pzrwm3"><canvas></canvas></div>',1),ba=f("<p>No se encontraron datos de distribución.</p>"),wa=f('<div class="statistics-page svelte-pzrwm3"><div class="header-container svelte-pzrwm3"><h1 class="svelte-pzrwm3">Estadísticas de Pedidos</h1> <div class="filter-controls svelte-pzrwm3"><button>Todos</button> <!></div></div> <!> <!>  <div><!></div></div>');function Ra(H,J){la(J,!1);let n=_([]),g=_(null),C=_(null),h=_(!0),b=_(),s=_(),w=_();const K=[20,50,100,1e3],R={in_transit:"En Tránsito",created:"Creado",delivered:"Entregado",cancelled:"Cancelado",in_distribution:"En Distribución",arrived:"Arribado",reserved:"Reservado"};async function E(t){console.log("Fetching data with limit:",t),d(h,!0),d(C,t);try{const e=await ua(fetch,a(C));console.log("Data received:",e),d(n,e),d(g,null)}catch(e){console.error("Error fetching data:",e),d(g,e.message||"Ocurrió un error al cargar los datos."),d(n,[])}finally{d(h,!1)}}oa(async()=>{if(console.log("Component mounted"),typeof window<"u")try{const t=await sa(()=>import("../chunks/CxR4x6W5.js"),[],import.meta.url);d(w,t.Chart);const{BarController:e,BarElement:r,CategoryScale:i,LinearScale:c,Tooltip:p,Legend:u,Title:y}=t;a(w).register(e,r,i,c,p,u,y),console.log("Chart.js loaded and registered")}catch(t){console.error("Failed to load Chart.js",t)}await E(null)}),ia(()=>{a(s)&&a(s).destroy()}),U(()=>(a(b),a(w),a(s)),()=>{if(a(b)&&a(w)&&!a(s)){console.log("Initializing chart instance");const t=a(b).getContext("2d");t&&d(s,new(a(w))(t,{type:"bar",data:{labels:[],datasets:[{label:"Cantidad de Pedidos",data:[],backgroundColor:"#f07c13",borderColor:"hsl(30, 88%, 41%)",borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0}},animation:{duration:500},plugins:{legend:{display:!1},title:{display:!0,text:"Distribución de Estados"}}}}))}}),U(()=>(a(s),a(n)),()=>{a(s)&&a(n)&&(console.log("Updating chart with data",a(n).length),V(s,a(s).data.labels=a(n).map(t=>R[t.status]||t.status)),V(s,a(s).data.datasets[0].data=a(n).map(t=>t.count)),a(s).update())}),na(),pa();var D=wa(),T=l(D),j=m(l(T),2),A=l(j);let B;var Q=m(A,2);q(Q,1,()=>K,G,(t,e)=>{var r=ma();let i;var c=l(r);o(r),z(()=>{i=L(r,1,"svelte-pzrwm3",null,i,{active:a(C)===a(e)}),x(c,`Últimos ${a(e)??""}`)}),Z("click",r,()=>E(a(e))),v(t,r)}),o(j),o(T);var F=m(T,2);{var X=t=>{var e=_a();v(t,e)};k(F,t=>{a(h)&&t(X)})}var I=m(F,2);{var Y=t=>{var e=fa(),r=l(e),i=l(r,!0);o(r),o(e),z(()=>x(i,a(g))),v(t,e)};k(I,t=>{a(g)&&t(Y)})}var O=m(I,2);let M;var $=l(O);{var aa=t=>{var e=ha(),r=W(e);q(r,5,()=>a(n),G,(p,u)=>{var y=ga(),P=l(y),ea=l(P,!0);o(P);var N=m(P,2),ra=l(N,!0);o(N),o(y),z(()=>{x(ea,(a(u),S(()=>a(u).count))),x(ra,(a(u),S(()=>R[a(u).status]||a(u).status)))}),v(p,y)}),o(r);var i=m(r,2),c=l(i);va(c,p=>d(b,p),()=>a(b)),o(i),v(t,e)},ta=t=>{var e=ca(),r=W(e);{var i=c=>{var p=ba();v(c,p)};k(r,c=>{!a(h)&&!a(g)&&c(i)},!0)}v(t,e)};k($,t=>{a(n),S(()=>a(n).length>0)?t(aa):t(ta,!1)})}o(O),o(D),z(()=>{B=L(A,1,"svelte-pzrwm3",null,B,{active:a(C)===null}),M=L(O,1,"content-wrapper svelte-pzrwm3",null,M,{"opacity-50":a(h)})}),Z("click",A,()=>E(null)),v(H,D),da()}export{Ra as component};
