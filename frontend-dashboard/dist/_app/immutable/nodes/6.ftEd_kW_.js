import{b as ca,u as ua}from"../chunks/DaeG8Ll7.js";import"../chunks/DsnmJJEf.js";import"../chunks/BfMTlK6c.js";import{p as fa,O as g,b as ma,ae as r,ah as t,ai as ha,ad as i,ac as h,x as a,aI as _a,u,aJ as ga,af as f}from"../chunks/BCZT5Dbg.js";import{s as d,e as ba}from"../chunks/CLcpye_t.js";import{f as c,a as p}from"../chunks/BpGtaleV.js";import{i as w}from"../chunks/njmLvgol.js";import{e as K,i as Q}from"../chunks/CLhoNAXF.js";import{b as xa}from"../chunks/CIpFx9H4.js";import{b as ya}from"../chunks/zfcsrDtj.js";import{p as Ea}from"../chunks/D4Caz1gY.js";import{i as Sa}from"../chunks/Ck-BG2pa.js";import{p as Da}from"../chunks/BboO_tbj.js";import{i as wa}from"../chunks/iSigOcxx.js";const Ca=async({params:C,fetch:b})=>{const{id:A}=C;return{shipmentDetails:await ca(A,b)}},Xa=Object.freeze(Object.defineProperty({__proto__:null,load:Ca},Symbol.toStringTag,{value:"Module"}));var Aa=c("<option> </option>"),Ma=c('<p class="error svelte-hnhpf2"> </p>'),Oa=c('<p class="success svelte-hnhpf2"> </p>'),ja=c('<li class="svelte-hnhpf2"><strong> </strong> <span class="log-status svelte-hnhpf2"> </span> - <span> </span></li>'),za=c('<ul class="logs-list svelte-hnhpf2"></ul>'),Na=c("<p>No hay historial de estados para este pedido.</p>"),ka=c('<h2> </h2> <p><strong>Estado Actual:</strong> <span class="current-status svelte-hnhpf2"> </span></p> <div class="form-section svelte-hnhpf2"><form><div class="form-group svelte-hnhpf2"><label for="status-select" class="svelte-hnhpf2">Nuevo Estado</label> <select id="status-select" class="svelte-hnhpf2"></select></div> <div class="form-group svelte-hnhpf2"><label for="message" class="svelte-hnhpf2">Mensaje (opcional)</label> <textarea id="message" rows="3" class="svelte-hnhpf2"></textarea></div> <button type="submit" class="submit-btn svelte-hnhpf2"> </button></form> <!> <!></div> <div class="logs-section svelte-hnhpf2"><h3>Historial de Estados</h3> <!></div>',1),Ga=c("<p>Cargando detalles del pedido...</p>"),Ia=c('<div class="status-container svelte-hnhpf2"><!></div>');function Ya(C,b){fa(b,!1);let A=Da(b,"data",8),{shipmentDetails:l}=A();const U=["created","reserved","in_distribution","in_transit","arrived","delivered","cancelled"],M={created:"Creado",reserved:"Reservado",in_distribution:"En Distribución",in_transit:"En Tránsito",arrived:"Arribado",delivered:"Entregado",cancelled:"Cancelado"};let x=g(l?.status||"created"),O=g("Estado actualizado por operador de logística."),y=g(!1),E=g(null),S=g(null);async function V(){if(l){f(y,!0),f(E,null),f(S,null);try{await ua(l.shipping_id.toString(),a(x),a(O))&&(f(S,"¡Estado actualizado con éxito!"),await wa())}catch(o){f(E,o.message||"Ocurrió un error desconocido.")}finally{f(y,!1)}}}function W(o){return o?new Date(o).toLocaleString("es-AR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):""}Sa();var j=Ia(),X=r(j);{var Y=o=>{var _=ka(),z=ha(_),$=r(z);t(z);var N=i(z,2),B=i(r(N),2),aa=r(B,!0);t(B),t(N);var k=i(N,2),D=r(k),G=r(D),I=i(r(G),2);h(()=>{a(x),_a(()=>{})}),K(I,5,()=>U,Q,(e,s)=>{var n=Aa(),v=r(n,!0);t(n);var m={};h(()=>{d(v,(a(s),u(()=>M[a(s)]))),m!==(m=a(s))&&(n.value=(n.__value=a(s))??"")}),p(e,n)}),t(I),t(G);var L=i(G,2),H=i(r(L),2);ga(H),t(L);var P=i(L,2),ea=r(P,!0);t(P),t(D);var J=i(D,2);{var ta=e=>{var s=Ma(),n=r(s,!0);t(s),h(()=>d(n,a(E))),p(e,s)};w(J,e=>{a(E)&&e(ta)})}var sa=i(J,2);{var ra=e=>{var s=Oa(),n=r(s,!0);t(s),h(()=>d(n,a(S))),p(e,s)};w(sa,e=>{a(S)&&e(ra)})}t(k);var q=i(k,2),ia=i(r(q),2);{var oa=e=>{var s=za();K(s,5,()=>u(()=>l.logs.slice().reverse()),Q,(n,v)=>{var m=ja(),R=r(m),na=r(R);t(R);var T=i(R,2),va=r(T,!0);t(T);var F=i(T,2),da=r(F,!0);t(F),t(m),h(pa=>{d(na,`${pa??""}:`),d(va,(a(v),u(()=>M[a(v).status]||a(v).status))),d(da,(a(v),u(()=>a(v).message)))},[()=>(a(v),u(()=>W(a(v).timestamp)))]),p(n,m)}),t(s),p(e,s)},la=e=>{var s=Na();p(e,s)};w(ia,e=>{u(()=>l.logs&&l.logs.length>0)?e(oa):e(la,!1)})}t(q),h(()=>{d($,`Cambiar Estado del Pedido #${u(()=>l.shipping_id)??""}`),d(aa,u(()=>M[l.status]||l.status)),P.disabled=a(y),d(ea,a(y)?"Guardando...":"Guardar Cambio")}),xa(I,()=>a(x),e=>f(x,e)),ya(H,()=>a(O),e=>f(O,e)),ba("submit",D,Ea(V)),p(o,_)},Z=o=>{var _=Ga();p(o,_)};w(X,o=>{l?o(Y):o(Z,!1)})}t(j),p(C,j),ma()}export{Ya as component,Xa as universal};
