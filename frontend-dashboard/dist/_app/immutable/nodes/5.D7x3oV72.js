import"../chunks/DsnmJJEf.js";import"../chunks/BfMTlK6c.js";import{c as ie,o as re}from"../chunks/BGtgH5ej.js";import{p as G,ac as W,ae as u,ad as i,x as e,b as Y,O as T,aI as le,ah as c,af as z,a4 as oe,u as I,ai as Q,g as V}from"../chunks/BCZT5Dbg.js";import{f as A,a as P,c as ne}from"../chunks/BpGtaleV.js";import{i as U}from"../chunks/njmLvgol.js";import{b as de}from"../chunks/DIFBLlPq.js";import{i as Z}from"../chunks/Ck-BG2pa.js";import{d as ve}from"../chunks/DaeG8Ll7.js";import{e as R,s as B}from"../chunks/CLcpye_t.js";import{r as H,s as ce}from"../chunks/BCGdHO_y.js";import{b as O}from"../chunks/zfcsrDtj.js";import{b as pe}from"../chunks/CIpFx9H4.js";import{e as ue,i as _e}from"../chunks/CLhoNAXF.js";import{s as ge}from"../chunks/zj_wkZCb.js";import{p as fe}from"../chunks/BboO_tbj.js";import{I as be}from"../chunks/BAVLDn9j.js";var me=A('<div class="filters-row svelte-970kgw"><div class="filter-grid svelte-970kgw"><input type="text" placeholder="Filtrar por ID..." class="svelte-970kgw"/> <input type="text" placeholder="Filtrar por destino..." class="svelte-970kgw"/> <select class="svelte-970kgw"><option>Todos los estados</option><option>En Tránsito</option><option>Creado</option><option>Entregado</option><option>Cancelado</option><option>En Distribución</option><option>Arribado</option><option>Reservado</option></select> <div class="date-filter svelte-970kgw"><label for="start-date" class="svelte-970kgw">Desde:</label> <input type="date" id="start-date" class="svelte-970kgw"/></div> <div class="date-filter svelte-970kgw"><label for="end-date" class="svelte-970kgw">Hasta:</label> <input type="date" id="end-date" class="svelte-970kgw"/></div></div> <button class="search-button svelte-970kgw" type="button" aria-label="Buscar pedidos">Buscar</button></div>');function he(j,L){G(L,!1);let m=T(""),x=T(""),C=T(""),h=T(""),w=T("");const $=ie();let y;function N(){clearTimeout(y),y=setTimeout(()=>{F()},300)}function F(){$("filterChange",{id:e(m).toUpperCase(),city:e(x).toLowerCase(),status:e(C),startDate:e(h),endDate:e(w)})}Z();var M=me(),o=u(M),d=u(o);H(d);var a=i(d,2);H(a);var t=i(a,2);W(()=>{e(C),le(()=>{})});var r=u(t);r.value=r.__value="";var l=i(r);l.value=l.__value="in_transit";var f=i(l);f.value=f.__value="created";var k=i(f);k.value=k.__value="delivered";var p=i(k);p.value=p.__value="cancelled";var s=i(p);s.value=s.__value="in_distribution";var _=i(s);_.value=_.__value="arrived";var g=i(_);g.value=g.__value="reserved",c(t);var v=i(t,2),b=i(u(v),2);H(b),c(v);var D=i(v,2),E=i(u(D),2);H(E),c(D),c(o);var S=i(o,2);c(M),O(d,()=>e(m),n=>z(m,n)),R("input",d,N),O(a,()=>e(x),n=>z(x,n)),R("input",a,N),pe(t,()=>e(C),n=>z(C,n)),R("change",t,F),O(b,()=>e(h),n=>z(h,n)),R("change",b,F),O(E,()=>e(w),n=>z(w,n)),R("change",E,F),R("click",S,F),P(j,M),Y()}var we=A('<a class="shipment-row-card svelte-ilg6z5"><div class="cell id-cell svelte-ilg6z5"><span class="mobile-label svelte-ilg6z5">ID Pedido:</span> <span> </span></div> <div class="cell svelte-ilg6z5"><span class="mobile-label svelte-ilg6z5">Destino:</span> <span> </span></div> <div class="cell svelte-ilg6z5"><span class="mobile-label svelte-ilg6z5">Estado:</span> <span class="status-pill svelte-ilg6z5"> </span></div> <div class="cell transport-cell svelte-ilg6z5"><span class="mobile-label svelte-ilg6z5">Transporte:</span> <!></div> <div class="cell date-cell svelte-ilg6z5"><span class="mobile-label svelte-ilg6z5">Ingreso:</span> <span> </span></div> <div class="cell date-cell svelte-ilg6z5"><span class="mobile-label svelte-ilg6z5">Entrega Est.:</span> <span> </span></div></a>'),ye=A('<div class="shipment-body"></div>'),ke=A('<div class="no-results-card svelte-ilg6z5">No se encontraron pedidos con los filtros seleccionados.</div>'),De=A('<div class="shipment-list-container svelte-ilg6z5"><div class="header-grid svelte-ilg6z5"><div>ID Pedido</div> <div>Destino</div> <div>Estado</div> <div>Transporte</div> <div>Ingreso</div> <div>Entrega Est.</div></div> <!></div>');function ze(j,L){G(L,!1);let m=fe(L,"shipments",24,()=>[]);const x={created:"Creado",reserved:"Reservado",in_transit:"En Tránsito",delivered:"Entregado",cancelled:"Cancelado",in_distribution:"En Distribución",arrived:"Arribado"},C={created:"#f0e68c",reserved:"#ffa07a",in_transit:"#add8e6",delivered:"#98fb98",cancelled:"#f08080",in_distribution:"#dda0dd",arrived:"#8fbc8f"};function h(o,d=1){if(!/^#([A-Fa-f0-9]{3}){1,2}$/.test(o))return"rgba(0,0,0,0)";let a=o.substring(1).split("");return a.length===3&&(a=[a[0],a[0],a[1],a[1],a[2],a[2]]),a="0x"+a.join(""),`rgba(${[a>>16&255,a>>8&255,a&255].join(",")},${d})`}function w(o,d){if(!/^#([A-Fa-f0-9]{3}){1,2}$/.test(o))return"#000000";let a=o.substring(1).split("");a.length===3&&(a=[a[0],a[0],a[1],a[1],a[2],a[2]]),a="0x"+a.join("");let t=a>>16&255,r=a>>8&255,l=a&255;t/=255,r/=255,l/=255;const f=Math.max(t,r,l),k=Math.min(t,r,l);let p=0,s,_=(f+k)/2;if(f===k)p=s=0;else{const v=f-k;switch(s=_>.5?v/(2-f-k):v/(f+k),f){case t:p=(r-l)/v+(r<l?6:0);break;case r:p=(l-t)/v+2;break;case l:p=(t-r)/v+4;break}p/=6}let g;if(["created","reserved","delivered","in_transit"].includes(d)?g=.1:g=_>.55?_-.5:_+.5,s===0)t=r=l=g;else{const v=(E,S,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<.16666666666666666?E+(S-E)*6*n:n<.5?S:n<.6666666666666666?E+(S-E)*(.6666666666666666-n)*6:E),b=g<.5?g*(1+s):g+s-g*s,D=2*g-b;t=v(D,b,p+1/3),r=v(D,b,p),l=v(D,b,p-1/3)}return t=Math.round(t*255),r=Math.round(r*255),l=Math.round(l*255),"#"+((1<<24)+(t<<16)+(r<<8)+l).toString(16).slice(1)}function $(o){if(!o)return"";const d=new Date(o),a=String(d.getDate()).padStart(2,"0"),t=String(d.getMonth()+1).padStart(2,"0"),r=d.getFullYear();return`${a}/${t}/${r}`}Z();var y=De(),N=i(u(y),2);{var F=o=>{var d=ye();ue(d,5,m,_e,(a,t)=>{var r=we(),l=u(r),f=i(u(l),2),k=u(f);c(f),c(l);var p=i(l,2),s=i(u(p),2),_=u(s,!0);c(s),c(p);var g=i(p,2),v=i(u(g),2),b=u(v,!0);c(v),c(g);var D=i(g,2),E=i(u(D),2);be(E,{get name(){return e(t),I(()=>e(t).transport_type)},className:"transport-icon"}),c(D);var S=i(D,2),n=i(u(S),2),X=u(n,!0);c(n),c(S);var J=i(S,2),K=i(u(J),2),q=u(K,!0);c(K),c(J),c(r),W((ee,te,ae,se)=>{ce(r,"href",`/shipments/${e(t),I(()=>e(t).shipping_id)??""}`),B(k,`#${e(t),I(()=>e(t).shipping_id)??""}`),B(_,(e(t),I(()=>e(t).delivery_address.locality_name))),ge(v,`background-color: ${ee??""}; color: ${te??""}`),B(b,(e(t),I(()=>x[e(t).status]||e(t).status))),B(X,ae),B(q,se)},[()=>(e(t),I(()=>h(C[e(t).status]||"#ccc",.7))),()=>(e(t),I(()=>w(C[e(t).status]||"#ccc",e(t).status))),()=>(e(t),I(()=>$(e(t).created_at))),()=>(e(t),I(()=>$(e(t).estimated_delivery_at)))]),P(a,r)}),c(d),P(o,d)},M=o=>{var d=ke();P(o,d)};U(N,o=>{oe(m()),I(()=>m().length>0)?o(F):o(M,!1)})}c(y),P(j,y),Y()}var Ee=A("<p>Cargando más pedidos...</p>"),xe=A("<p>No hay más pedidos para cargar.</p>"),Ce=A('<h2>Dashboard de Pedidos</h2> <p>Listado de Pedidos</p> <!> <!> <!> <div style="height: 1px; margin-top: -1px;"></div>',1);function Ye(j,L){G(L,!1);let m=T([]),x=1,C=1,h=T(!1),w=T(!0),$,y=T();const N=100;let F={id:"",city:"",status:"",startDate:"",endDate:""};async function M(){if(!(e(h)||!e(w))){z(h,!0);try{const s=await ve(x,N,F);z(m,[...e(m),...s.shipments]),C=s.pagination.total_pages,z(w,x<C),x++}catch(s){console.error("Error loading shipments:",s)}finally{z(h,!1)}}}async function o(){if(!(e(h)||!e(w)))for(await M(),await V();e(w)&&!e(h)&&e(y)&&e(y).getBoundingClientRect().top<=window.innerHeight;)await M(),await V()}async function d(s){F=s.detail,z(m,[]),x=1,z(w,!0),await o()}re(()=>(o(),$=new IntersectionObserver(s=>{const[_]=s;_.isIntersecting&&e(w)&&!e(h)&&M()},{threshold:.1}),e(y)&&$.observe(e(y)),()=>{$&&$.disconnect()})),Z();var a=Ce(),t=i(Q(a),4);he(t,{$$events:{filterChange:d}});var r=i(t,2);ze(r,{get shipments(){return e(m)}});var l=i(r,2);{var f=s=>{var _=Ee();P(s,_)},k=s=>{var _=ne(),g=Q(_);{var v=b=>{var D=xe();P(b,D)};U(g,b=>{!e(w)&&e(m).length>0&&b(v)},!0)}P(s,_)};U(l,s=>{e(h)?s(f):s(k,!1)})}var p=i(l,2);de(p,s=>z(y,s),()=>e(y)),P(j,a),Y()}export{Ye as component};
